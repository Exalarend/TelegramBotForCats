# –ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–æ –Ω–µ —Ç–≤–æ–∏—Ö —Å–æ–±–∞—á—å–∏—Ö –¥–µ–ª ‚Äî Telegram-–±–æ—Ç (Python)

–ë–æ—Ç –ø—Ä–∏—Å—ã–ª–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —á–∞—Ç **–≤ —Ä–∞–∑–Ω—ã–µ –¥–Ω–∏ –∏ —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è**.  
–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ, –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ, —Ç–µ–∫—Å—Ç –∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è **–∏–∑ –º–µ–Ω—é –±–æ—Ç–∞**.  
–¢–∞–∫–∂–µ –µ—Å—Ç—å **‚≠ê —Å–∏—Å—Ç–µ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –±–æ—Ç–∞ –≤ —á–∞—Ç –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ YAML.

## –ß—Ç–æ —É–º–µ–µ—Ç

- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–æ–±—ã—á–Ω—ã–µ)**:
  - –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏ + –≤—Ä–µ–º–µ–Ω–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ü–Ω/–°—Ä/–ü—Ç –≤ 09:30)
  - –ø–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: –∫–∞–∂–¥—ã–µ 120 –º–∏–Ω—É—Ç)
  - —É –∫–∞–∂–¥–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –µ—Å—Ç—å **–Ω–∞–∑–≤–∞–Ω–∏–µ** (–µ–≥–æ –º–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å)
  - —É –∫–∞–∂–¥–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–≤–æ–π **—Ç–µ–∫—Å—Ç** –∏ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è **–∫–∞—Ä—Ç–∏–Ω–∫–∞**
  - –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å **–≤—Ä–µ–º—è/–∏–Ω—Ç–µ—Ä–≤–∞–ª**, —Ç–µ–∫—Å—Ç, –∫–∞—Ä—Ç–∏–Ω–∫—É, –≤–∫–ª—é—á–∞—Ç—å/–≤—ã–∫–ª—é—á–∞—Ç—å, —É–¥–∞–ª—è—Ç—å
- **‚≠ê –°–∏—Å—Ç–µ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)**:
  - —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ —á–∞—Ç
  - –º–æ–∂–Ω–æ **–≤–∫–ª/–≤—ã–∫–ª** –∏ –º–µ–Ω—è—Ç—å **–≤—Ä–µ–º—è/–∏–Ω—Ç–µ—Ä–≤–∞–ª**
  - –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—ë—Ç—Å—è **—Ç–æ–ª—å–∫–æ –≤ YAML**, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥—É—Ç –µ–≥–æ –º–µ–Ω—è—Ç—å
  - –Ω–µ–ª—å–∑—è –º–µ–Ω—è—Ç—å —Ç–µ–∫—Å—Ç/–∫–∞—Ä—Ç–∏–Ω–∫—É –∏ –Ω–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å
  - –∫–æ–Ω—Ç–µ–Ω—Ç –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ –ø–æ –≤–µ—Å–∞–º: **–∫–∞—Ä—Ç–∏–Ω–∫–∞ ‚Üí —Ç–µ–∫—Å—Ç**
- **–†–µ–∂–∏–º —Å–æ–æ–±—â–µ–Ω–∏–π**: ‚Äú—Å –∏–Ω—Ñ–æ (–¥–∞—Ç–∞/–≤—Ä–µ–º—è)‚Äù –∏–ª–∏ ‚Äú—Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç‚Äù
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ **SQLite** –∏ –ø–æ–¥–Ω–∏–º–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
  - –î–ª—è interval-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å—á–∏—Ç–∞–µ—Ç—Å—è **–æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏** (–ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç –Ω–µ ‚Äú—Å—Ç—Ä–µ–ª—è–µ—Ç —Å—Ä–∞–∑—É‚Äù).

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Windows / PowerShell)

1) –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —É **@BotFather** –∏ –ø–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω.

2) –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
python -m venv .venv
.\.venv\Scripts\activate
pip install -r requirements.txt
```

3) –°–æ–∑–¥–∞–π—Ç–µ `.env` —Ä—è–¥–æ–º —Å `main.py` –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω:

```env
BOT_TOKEN=...
BOT_DB_PATH=data/bot.db
DEFAULT_TIMEZONE=Europe/Moscow
SYSTEM_NOTIFICATIONS_YAML=config/system_notifications.yaml
BOT_API_TIMEOUT_SECONDS=20
BOT_API_RETRY_ATTEMPTS=4
BOT_API_POOL_TIMEOUT_SECONDS=10
LOG_LEVEL=INFO
```

4) –ó–∞–ø—É—Å–∫:

```bash
python main.py
```

## –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —á–∞—Ç–µ

- –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ –Ω—É–∂–Ω—ã–π —á–∞—Ç (–∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –µ–º—É –≤ –ª–∏—á–∫—É)
- –í —á–∞—Ç–µ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
- –ß–µ—Ä–µ–∑ –º–µ–Ω—é:
  - **üìÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** ‚Üí –¥–æ–±–∞–≤–∏—Ç—å/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
  - **‚úÖ –ò–Ω—Ñ–æ (–¥–∞—Ç–∞/–≤—Ä–µ–º—è) / ‚¨ú –¢–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç** ‚Üí –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å ‚Äú—à–∞–ø–∫—É‚Äù –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
  - **üü¢ –í–∫–ª/–í—ã–∫–ª** ‚Üí –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Ü–µ–ª–∏–∫–æ–º –¥–ª—è —á–∞—Ç–∞

## –°–∏—Å—Ç–µ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ YAML

–§–∞–π–ª –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `config/system_notifications.yaml`.
–£ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –µ—Å—Ç—å –ø–æ–ª–µ `title` ‚Äî –æ–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –º–µ–Ω—é –∏ –≤ ‚Äú—à–∞–ø–∫–µ‚Äù —Å–æ–æ–±—â–µ–Ω–∏–π (–µ—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω —Ä–µ–∂–∏–º ‚Äú—Å –∏–Ω—Ñ–æ‚Äù).

### –ö–∞–∫ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–Ω—Ç

- –í—ã–±–∏—Ä–∞–µ—Ç—Å—è **–æ–¥–Ω–∞** –∫–∞—Ä—Ç–∏–Ω–∫–∞ –∏–∑ `images` –ø–æ –≤–µ—Å–∞–º (`weight`)
- –ó–∞—Ç–µ–º –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è **—Ç–µ–∫—Å—Ç –∏–∑ –Ω–∞–±–æ—Ä–∞ —ç—Ç–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏** (`texts`) —Ç–æ–∂–µ –ø–æ –≤–µ—Å–∞–º

–ï—Å–ª–∏ `ref_type: path` –∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç ‚Äî –≤–∞—Ä–∏–∞–Ω—Ç –Ω–µ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è.

### –î–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –≤ YAML

–í `schedule.days` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω—É–º–µ—Ä–∞—Ü–∏—è –∫–∞–∫ –≤ Python: **–ü–Ω=0 ‚Ä¶ –í—Å=6**.

## –ö–∞—Ä—Ç–∏–Ω–∫–∏ –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

–ü–∞–ø–∫–∞: `assets/system/` (—Å–º. `assets/system/README.md`).  
–≠—Ç–∏ –ø—É—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ YAML –∫–∞–∫ `ref` –ø—Ä–∏ `ref_type: path`.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)

- `main.py` ‚Äî —Ç–æ–Ω–∫–∏–π entrypoint
- `bot/` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞:
  - `bot/app.py` ‚Äî —Å–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è handlers
  - `bot/run.py` ‚Äî –∑–∞–ø—É—Å–∫ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ
  - `bot/scheduler.py` ‚Äî JobQueue –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
  - `bot/db/` ‚Äî —Å—Ö–µ–º–∞ –∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π SQLite
  - `bot/system/` ‚Äî YAML –∑–∞–≥—Ä—É–∑–∫–∞ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
  - `bot/notify/` ‚Äî –≤—ã–±–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ (retry/backoff)
  - `bot/handlers/` ‚Äî –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π/–∫–Ω–æ–ø–æ–∫
- `src/db.py` ‚Äî —Å–ª–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ (–ø–µ—Ä–µ—ç–∫—Å–ø–æ—Ä—Ç DB API)

## –ì—Ä—É–ø–ø—ã / privacy mode

- –í –≥—Ä—É–ø–ø–∞—Ö –º–µ–Ω—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–≥—É—Ç —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã.
- –ï—Å–ª–∏ –±–æ—Ç ‚Äú–Ω–µ –≤–∏–¥–∏—Ç‚Äù —Å–æ–æ–±—â–µ–Ω–∏—è —Å –≤–≤–æ–¥–æ–º –≤—Ä–µ–º–µ–Ω–∏/—Ç–µ–∫—Å—Ç–∞ ‚Äî –≤ –≥—Ä—É–ø–ø–∞—Ö —á–∞—Å—Ç–æ –≤–∫–ª—é—á—ë–Ω privacy mode.  
  –û–±—ã—á–Ω–æ –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç–∫–ª—é—á–∏—Ç—å —É BotFather: `/setprivacy` ‚Üí **Disable** (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ—Ç–∞).

## Troubleshooting

- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–µ –ø—Ä–∏—à–ª–æ, –Ω–æ —Ç—Ä–∏–≥–≥–µ—Ä —Å—Ä–∞–±–æ—Ç–∞–ª**: –≤–µ—Ä–æ—è—Ç–Ω–æ —Å–µ—Ç–µ–≤–æ–π —Ç–∞–π–º–∞—É—Ç –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤ Telegram API (`TimedOut`).  
  –†–µ—à–µ–Ω–∏—è: —É–≤–µ–ª–∏—á–∏—Ç—å `BOT_API_TIMEOUT_SECONDS`, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç/—Ñ–∞–µ—Ä–≤–æ–ª, –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–∞ VPS, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏.

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

```bash
pytest -q
```

–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–Ω—Ç–µ—Ä–æ–º (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω):

```bash
ruff check .
```

